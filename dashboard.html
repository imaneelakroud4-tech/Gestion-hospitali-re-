<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>Gestion Hospitalière</title>

<style>
/* ===== BASE (existant, non modifié) ===== */
body{margin:0;font-family:Arial}
.menu{width:220px;background:#af1010;height:100vh;position:fixed;color:white;padding:10px}
.menu a{display:block;color:white;padding:6px;text-decoration:none;background:#7a1c1c;margin-bottom:4px}
.menu a:hover{background:#330404}
.content{margin-left:230px;padding:15px}
table{width:100%;border-collapse:collapse;margin-top:10px}
th,td{border:1px solid #aaa;padding:5px;text-align:center}
input,select,button{margin:4px;padding:5px}

/* ===== AJOUT CSS (AMÉLIORATION VISUELLE) ===== */
body{
  background: #f8f7f7;;
}

/* Menu */
.menu h3{
  text-align:center;
  margin-bottom:15px;
}
.menu a{
  border-radius:4px;
  transition:0.3s;
}

/* Contenu */
.content h2{
  margin-top:0;
  color:#1f2937;
}

/* Formulaires */
input, select{
  width:250px;
  border:1px solid #ccc;
  border-radius:4px;
}
button{
  background:#5e0c0c;
  color:white;
  border:none;
  border-radius:4px;
  cursor:pointer;
}
button:hover{
  background:#380202;
}

/* Tableaux */
table{
  background:white;
}
th{
  background:#800202;
  color:white;
}
tr:nth-child(even){
  background:#f1f5f9;
}

/* Boutons actions dans tableau */
table button{
  background:#5cfb00;
  padding:4px 8px;
}
table button:last-child{
  background:#db130f;
}

</style>
</head>

<body>

<script>
if(!localStorage.getItem("auth")) location.href="index.html";
</script>

<div class="menu">
<h3>Menu</h3>
<a href="?page=patients">Patients</a>
<a href="?page=doctors">Médecins</a>
<a href="?page=appointments">Rendez-vous</a>
<a href="?page=prescriptions">Prescriptions</a>
<a href="?page=services">Services</a>
<a href="#" onclick="logout()">Logout</a>
</div>

<div class="content" id="app"></div>

<script>
// ================= STORAGE =================
let patients = JSON.parse(localStorage.getItem("patients")) || [];
let doctors = JSON.parse(localStorage.getItem("doctors")) || [];
let appointments = JSON.parse(localStorage.getItem("appointments")) || [];
let prescriptions = JSON.parse(localStorage.getItem("prescriptions")) || [];
let services = JSON.parse(localStorage.getItem("services")) || [];
let editIndex = null;

const page = new URLSearchParams(location.search).get("page");

// ================= ROUTER =================
if(page==="patients") patientsPage();
else if(page==="doctors") doctorsPage();
else if(page==="appointments") appointmentsPage();
else if(page==="prescriptions") prescriptionsPage();
else if(page==="services") servicesPage();
else app.innerHTML="<h2>Bienvenue</h2>";

// ================= PATIENTS =================
function patientsPage(){
app.innerHTML=`
<h2>Patients</h2>
<input id="nom" placeholder="Nom">
<input id="age" placeholder="Age">
<input id="tel" placeholder="Téléphone">
<button onclick="savePatient()">Enregistrer</button>

<table>
<tr><th>Nom</th><th>Age</th><th>Téléphone</th><th>Actions</th></tr>
${patients.map((p,i)=>`
<tr>
<td>${p.nom}</td><td>${p.age}</td><td>${p.tel}</td>
<td>
<button onclick="editPatient(${i})">Modifier</button>
<button onclick="deleteItem(patients,${i},'patients')">Supprimer</button>
</td>
</tr>`).join("")}
</table>`;
}
function savePatient(){
  if(editIndex==null) patients.push({nom:nom.value,age:age.value,tel:tel.value});
  else { patients[editIndex]={nom:nom.value,age:age.value,tel:tel.value}; editIndex=null; }
  localStorage.setItem("patients",JSON.stringify(patients));
  patientsPage();
}
function editPatient(i){
  nom.value=patients[i].nom; age.value=patients[i].age; tel.value=patients[i].tel;
  editIndex=i;
}

// ================= DOCTORS =================
function doctorsPage(){
app.innerHTML=`
<h2>Médecins</h2>
<input id="nom" placeholder="Nom">
<input id="spec" placeholder="Spécialité">
<button onclick="saveDoctor()">Enregistrer</button>

<table>
<tr><th>Nom</th><th>Spécialité</th><th>Actions</th></tr>
${doctors.map((d,i)=>`
<tr>
<td>${d.nom}</td><td>${d.spec}</td>
<td>
<button onclick="editDoctor(${i})">Modifier</button>
<button onclick="deleteItem(doctors,${i},'doctors')">Supprimer</button>
</td>
</tr>`).join("")}
</table>`;
}
function saveDoctor(){
  if(editIndex==null) doctors.push({nom:nom.value,spec:spec.value});
  else { doctors[editIndex]={nom:nom.value,spec:spec.value}; editIndex=null; }
  localStorage.setItem("doctors",JSON.stringify(doctors));
  doctorsPage();
}
function editDoctor(i){
  nom.value=doctors[i].nom; spec.value=doctors[i].spec;
  editIndex=i;
}

// ================= RENDEZ-VOUS =================
function appointmentsPage(){
app.innerHTML=`
<h2>Rendez-vous</h2>
<select id="patient">${patients.map(p=>`<option>${p.nom}</option>`).join("")}</select>
<select id="doctor">${doctors.map(d=>`<option>${d.nom}</option>`).join("")}</select>
<input id="date" type="date">
<button onclick="saveAppointment()">Ajouter</button>

<table>
<tr><th>Patient</th><th>Médecin</th><th>Date</th></tr>
${appointments.map(a=>`<tr><td>${a.patient}</td><td>${a.doctor}</td><td>${a.date}</td></tr>`).join("")}
</table>`;
}
function saveAppointment(){
  appointments.push({patient:patient.value,doctor:doctor.value,date:date.value});
  localStorage.setItem("appointments",JSON.stringify(appointments));
  appointmentsPage();
}

// ================= PRESCRIPTIONS =================
function prescriptionsPage(){
app.innerHTML=`
<h2>Prescriptions</h2>
<select id="patient">${patients.map(p=>`<option>${p.nom}</option>`).join("")}</select>
<select id="doctor">${doctors.map(d=>`<option>${d.nom}</option>`).join("")}</select>
<input id="med" placeholder="Médicament">
<button onclick="savePrescription()">Ajouter</button>

<table>
<tr><th>Patient</th><th>Médecin</th><th>Médicament</th></tr>
${prescriptions.map(p=>`<tr><td>${p.patient}</td><td>${p.doctor}</td><td>${p.med}</td></tr>`).join("")}
</table>`;
}
function savePrescription(){
  prescriptions.push({patient:patient.value,doctor:doctor.value,med:med.value});
  localStorage.setItem("prescriptions",JSON.stringify(prescriptions));
  prescriptionsPage();
}

// ================= SERVICES =================
function servicesPage(){
app.innerHTML=`
<h2>Services</h2>
<input id="nom" placeholder="Service">
<select id="doctor">${doctors.map(d=>`<option>${d.nom}</option>`).join("")}</select>
<button onclick="saveService()">Ajouter</button>

<table>
<tr><th>Service</th><th>Médecin</th></tr>
${services.map(s=>`<tr><td>${s.nom}</td><td>${s.doctor}</td></tr>`).join("")}
</table>`;
}
function saveService(){
  services.push({nom:nom.value,doctor:doctor.value});
  localStorage.setItem("services",JSON.stringify(services));
  servicesPage();
}

// ================= COMMON =================
function deleteItem(arr,i,key){
  if(confirm("Supprimer ?")){
    arr.splice(i,1);
    localStorage.setItem(key,JSON.stringify(arr));
    location.reload();
  }
}
function logout(){ localStorage.clear(); location.href="index.html"; }
</script>

</body>
</html>
